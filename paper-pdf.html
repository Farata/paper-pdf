<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="pdfjs-import.html">

<!--
An element providing a solution to no problem in particular.

Example:

    <paper-pdf></paper-pdf>

@group Seed Elements
@element paper-pdf
@demo demo/index.html
@hero hero.svg
-->
<dom-module id="paper-pdf">

  <template>
    <style>
      :host {
        display: block;
        box-sizing: border-box;
      }
    </style>

    <div id="container">
      <div class="pdfViewer"></div>
    </div>

  </template>

</dom-module>

<script>

  Polymer({

    is: 'paper-pdf',

    properties: {

      /**
       * `src` specifies URL to load a PDF document.
       */
      src: {
        type: String,
        value: 'demo/demo.pdf'
      }

    },

    listeners: {
      'container.pagesinit': 'onPagesInit'
    },

    created: function () {
      PDFJS.workerSrc = '../../pdfjs-dist/build/pdf.worker.js';
    },

    attached: function () {
      this.viewer = new PDFJS.PDFViewer({
        container: this.$.container
      });

      PDFJS.getDocument(this.src).then(function (document) {
        this.viewer.setDocument(document);
      }.bind(this));
    },

    onPagesInit: function () {
      this.viewer.currentScaleValue = 'page-width';
    },

    detached: function() {
      // The analog to `attached`, `detached` fires when the element has been
      // removed from a document.
      //
      // Use this to clean up anything you did in `attached`.
    },

    // Element Behavior

    /**
     * The `paper-pdf-lasers` event is fired whenever `fireLasers` is called.
     *
     * @event paper-pdf-lasers
     * @detail {{sound: String}}
     */

    /**
     * Sometimes it's just nice to say hi.
     *
     * @param {string} greeting A positive greeting.
     * @return {string} The full greeting.
     */
    sayHello: function(greeting) {
      var response = greeting || 'Hello World!';
      return 'paper-pdf says, ' + response;
    },

    /**
     * Attempt to destroy this element's enemies with a beam of light!
     *
     * Or, at least, dispatch an event in the vain hope that someone else will
     * do the zapping.
     */
    fireLasers: function() {
      this.fire('paper-pdf-lasers', {sound: 'Pew pew!'});
    }

  });

</script>
